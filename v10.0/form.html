<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAS 轉址中...</title>
    <meta http-equiv="refresh" content="5;url=https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec">
</head>
<body>
    <h1>正在轉址到牙材券消費表單...</h1>
    <p>如果瀏覽器沒有自動跳轉，請 <a id="redirectLink" href="https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec">點擊這裡</a>。</p>
    <script>
        // 1. 設定您的 GAS 部署網址（基礎網址）
        const BASE_GAS_URL = 'https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec';
        
        // 2. 獲取當前網址的所有參數
        const urlParams = new URLSearchParams(window.location.search);
        
        // **!!! 關鍵調整：現在檢查 'vendorCode' 參數 !!!**
        const vendorCodeValue = urlParams.get('vendorCode'); // <-- 關鍵：使用 vendorCode
        
        let finalRedirectURL = BASE_GAS_URL;

        if (vendorCodeValue) {
            // 4. 構造帶 vendorCode 參數的 GAS 網址
            finalRedirectURL = BASE_GAS_URL + '?vendorCode=' + encodeURIComponent(vendorCodeValue); // <-- 關鍵：使用 vendorCode
            console.log("偵測到 vendorCode 參數，轉址至: " + finalRedirectURL);
        } else {
            // 5. 如果沒有 'vendorCode' 參數，就使用基礎網址
            console.log("未偵測到 vendorCode 參數，轉址至: " + BASE_GAS_URL);
        }

        // 6. 進行轉址
        window.location.href = finalRedirectURL;
        
        // 7. 更新超連結
        document.getElementById('redirectLink').href = finalRedirectURL;
    </script>
</body>
</html>
