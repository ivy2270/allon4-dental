<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAS 轉址中...</title>
    <meta http-equiv="refresh" content="5;url=https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec">
</head>
<body>
    <h1>正在轉址到牙材券消費表單...</h1>
    <p>如果瀏覽器沒有自動跳轉，請 <a id="redirectLink" href="https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec">點擊這裡</a>。</p>

    <script>
        // 1. 設定您的 GAS 部署網址（基礎網址）
        const BASE_GAS_URL = 'https://script.google.com/macros/s/AKfycbyNhuBu5d4yObAuxAHpXP1FbrkWwBLzoiWTUVZMioj4MZSW4wEVTGQkzHqaLunLrLhK8Q/exec';
        
        // 2. 獲取當前網址的所有參數
        // 例如：當前網址是 http://yourdomain.com/index.html?vendor=ACME
        const urlParams = new URLSearchParams(window.location.search);
        
        // 3. 檢查是否有 'vendor' 參數
        const vendorValue = urlParams.get('vendor');
        
        let finalRedirectURL = BASE_GAS_URL;

        if (vendorValue) {
            // 4. 如果有 'vendor' 參數，則構造帶參數的 GAS 網址
            // 由於您的 GAS 網址本身沒有參數，所以我們直接在後面加上 ?vendor=值
            // 如果 GAS 網址已經有參數，需要用 & 符號連接
            finalRedirectURL = BASE_GAS_URL + '?vendor=' + encodeURIComponent(vendorValue);
            console.log("偵測到 vendor 參數，轉址至: " + finalRedirectURL);
        } else {
            // 5. 如果沒有 'vendor' 參數，就使用基礎網址
            console.log("未偵測到 vendor 參數，轉址至: " + BASE_GAS_URL);
        }

        // 6. 進行轉址
        window.location.href = finalRedirectURL;
        
        // 7. 更新超連結，以防 JavaScript 執行失敗
        document.getElementById('redirectLink').href = finalRedirectURL;
    </script>
</body>
</html>
